<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Using the compiler | The AssemblyScript Book</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/favicons/safari-pinned-tab.svg" color="#007acc">
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    <meta name="description" content="How to use the compiler from the command line or as an API.">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-config" content="/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <link rel="preload" href="/assets/css/0.styles.6b61c7e6.css" as="style"><link rel="preload" href="/assets/js/app.f1b33501.js" as="script"><link rel="preload" href="/assets/js/4.bff817ab.js" as="script"><link rel="preload" href="/assets/js/3.414e7e2a.js" as="script"><link rel="preload" href="/assets/js/22.ec6e0f2b.js" as="script"><link rel="prefetch" href="/assets/js/10.b593aa85.js"><link rel="prefetch" href="/assets/js/11.e70694b8.js"><link rel="prefetch" href="/assets/js/12.eac7b90f.js"><link rel="prefetch" href="/assets/js/13.a23bc4f4.js"><link rel="prefetch" href="/assets/js/14.38407d5c.js"><link rel="prefetch" href="/assets/js/15.02c39193.js"><link rel="prefetch" href="/assets/js/16.a1bfe727.js"><link rel="prefetch" href="/assets/js/17.ebe32f37.js"><link rel="prefetch" href="/assets/js/18.e8b2f77f.js"><link rel="prefetch" href="/assets/js/19.70bbb3ef.js"><link rel="prefetch" href="/assets/js/20.10384fec.js"><link rel="prefetch" href="/assets/js/21.be1cd998.js"><link rel="prefetch" href="/assets/js/23.ed294d2e.js"><link rel="prefetch" href="/assets/js/24.ee2d454f.js"><link rel="prefetch" href="/assets/js/25.4832a41c.js"><link rel="prefetch" href="/assets/js/26.1f14f079.js"><link rel="prefetch" href="/assets/js/27.009b8d6a.js"><link rel="prefetch" href="/assets/js/28.017690b8.js"><link rel="prefetch" href="/assets/js/29.deffbf5a.js"><link rel="prefetch" href="/assets/js/30.78910ed6.js"><link rel="prefetch" href="/assets/js/31.0484fd41.js"><link rel="prefetch" href="/assets/js/32.e1c049c4.js"><link rel="prefetch" href="/assets/js/33.da8b2030.js"><link rel="prefetch" href="/assets/js/34.d1e48b63.js"><link rel="prefetch" href="/assets/js/35.b47ea88b.js"><link rel="prefetch" href="/assets/js/36.416acfe9.js"><link rel="prefetch" href="/assets/js/37.3f85406d.js"><link rel="prefetch" href="/assets/js/38.d5db98ff.js"><link rel="prefetch" href="/assets/js/39.1be357c1.js"><link rel="prefetch" href="/assets/js/40.e15903d4.js"><link rel="prefetch" href="/assets/js/41.a89c2275.js"><link rel="prefetch" href="/assets/js/42.5572b290.js"><link rel="prefetch" href="/assets/js/43.df288269.js"><link rel="prefetch" href="/assets/js/44.2b40b0bd.js"><link rel="prefetch" href="/assets/js/45.dc56303f.js"><link rel="prefetch" href="/assets/js/46.93b5c200.js"><link rel="prefetch" href="/assets/js/47.d9d9adb4.js"><link rel="prefetch" href="/assets/js/48.fce08686.js"><link rel="prefetch" href="/assets/js/49.e6f5700b.js"><link rel="prefetch" href="/assets/js/5.edada466.js"><link rel="prefetch" href="/assets/js/50.89840f69.js"><link rel="prefetch" href="/assets/js/51.d59a0117.js"><link rel="prefetch" href="/assets/js/52.41b29d96.js"><link rel="prefetch" href="/assets/js/53.af7628ce.js"><link rel="prefetch" href="/assets/js/54.289d022c.js"><link rel="prefetch" href="/assets/js/55.1fea72c5.js"><link rel="prefetch" href="/assets/js/6.01d77bdc.js"><link rel="prefetch" href="/assets/js/7.906aac1c.js"><link rel="prefetch" href="/assets/js/8.c2cacdf2.js"><link rel="prefetch" href="/assets/js/9.c701ed4b.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.2967e2f6.js">
    <link rel="stylesheet" href="/assets/css/0.styles.6b61c7e6.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-7c0e63ba><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/images/icon.svg" alt="The AssemblyScript Book" class="logo"> <span class="site-name can-hide">The AssemblyScript Book</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><a href="/introduction.html" class="nav-link">
  Documentation
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Examples" class="dropdown-title"><span class="title">Examples</span> <span class="arrow down"></span></button> <button type="button" aria-label="Examples" class="mobile-dropdown-title"><span class="title">Examples</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/examples.html" class="nav-link">
  Overview
</a></li><li class="dropdown-item"><!----> <a href="/built-with-assemblyscript.html" class="nav-link">
  Built with AssemblyScript
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Community" class="dropdown-title"><span class="title">Community</span> <span class="arrow down"></span></button> <button type="button" aria-label="Community" class="mobile-dropdown-title"><span class="title">Community</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/AssemblyScript/assemblyscript/blob/main/CONTRIBUTING.md" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Contributing guidelines
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/AssemblyScript/assemblyscript/blob/main/CODE_OF_CONDUCT.md" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Code of Conduct
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><h4>
          Social
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://twitter.com/AssemblyScript" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Twitter
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://discord.gg/assemblyscript" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Discord
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li><li class="dropdown-item"><h4>
          Q&amp;A
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://stackoverflow.com/questions/tagged/assemblyscript" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Stack Overflow
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li></ul></div></div><div class="nav-item"><a href="https://opencollective.com/assemblyscript" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Support us
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/AssemblyScript" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/introduction.html" class="nav-link">
  Documentation
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Examples" class="dropdown-title"><span class="title">Examples</span> <span class="arrow down"></span></button> <button type="button" aria-label="Examples" class="mobile-dropdown-title"><span class="title">Examples</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/examples.html" class="nav-link">
  Overview
</a></li><li class="dropdown-item"><!----> <a href="/built-with-assemblyscript.html" class="nav-link">
  Built with AssemblyScript
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Community" class="dropdown-title"><span class="title">Community</span> <span class="arrow down"></span></button> <button type="button" aria-label="Community" class="mobile-dropdown-title"><span class="title">Community</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/AssemblyScript/assemblyscript/blob/main/CONTRIBUTING.md" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Contributing guidelines
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/AssemblyScript/assemblyscript/blob/main/CODE_OF_CONDUCT.md" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Code of Conduct
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><h4>
          Social
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://twitter.com/AssemblyScript" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Twitter
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://discord.gg/assemblyscript" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Discord
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li><li class="dropdown-item"><h4>
          Q&amp;A
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://stackoverflow.com/questions/tagged/assemblyscript" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Stack Overflow
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li></ul></div></div><div class="nav-item"><a href="https://opencollective.com/assemblyscript" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Support us
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/AssemblyScript" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/introduction.html" class="sidebar-link">Introduction</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/introduction.html#from-a-webassembly-perspective" class="sidebar-link">From a WebAssembly perspective</a></li><li class="sidebar-sub-header"><a href="/introduction.html#from-a-javascript-perspective" class="sidebar-link">From a JavaScript perspective</a></li><li class="sidebar-sub-header"><a href="/introduction.html#frequently-asked-questions" class="sidebar-link">Frequently asked questions</a></li></ul></li><li><a href="/getting-started.html" class="sidebar-link">Getting started</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/getting-started.html#setting-up-a-new-project" class="sidebar-link">Setting up a new project</a></li><li class="sidebar-sub-header"><a href="/getting-started.html#working-with-your-module" class="sidebar-link">Working with your module</a></li><li class="sidebar-sub-header"><a href="/getting-started.html#the-journey-ahead" class="sidebar-link">The journey ahead</a></li></ul></li><li><a href="/compiler.html" aria-current="page" class="active sidebar-link">Using the compiler</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/compiler.html#compiler-options" class="sidebar-link">Compiler options</a></li><li class="sidebar-sub-header"><a href="/compiler.html#configuration-file" class="sidebar-link">Configuration file</a></li><li class="sidebar-sub-header"><a href="/compiler.html#programmatic-usage" class="sidebar-link">Programmatic usage</a></li><li class="sidebar-sub-header"><a href="/compiler.html#host-bindings" class="sidebar-link">Host bindings</a></li><li class="sidebar-sub-header"><a href="/compiler.html#debugging-2" class="sidebar-link">Debugging</a></li><li class="sidebar-sub-header"><a href="/compiler.html#transforms" class="sidebar-link">Transforms</a></li><li class="sidebar-sub-header"><a href="/compiler.html#portability" class="sidebar-link">Portability</a></li></ul></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Using the language</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/concepts.html" class="sidebar-link">Concepts</a></li><li><a href="/types.html" class="sidebar-link">Types</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Standard library</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/status.html" class="sidebar-link">Implementation status</a></li></ul></section></li><li><a href="/runtime.html" class="sidebar-link">Using the runtime</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/runtime.html#variants" class="sidebar-link">Variants</a></li><li class="sidebar-sub-header"><a href="/runtime.html#interface" class="sidebar-link">Interface</a></li><li class="sidebar-sub-header"><a href="/runtime.html#memory-layout" class="sidebar-link">Memory layout</a></li><li class="sidebar-sub-header"><a href="/runtime.html#calling-convention" class="sidebar-link">Calling convention</a></li></ul></li></ul> </aside> <main class="page" data-v-bb3fd134> <div class="theme-default-content content__default" data-v-bb3fd134><h1 id="using-the-compiler"><a href="#using-the-compiler" class="header-anchor">#</a> Using the compiler</h1> <p>Similar to TypeScript's <code>tsc</code> transpiling to JavaScript, AssemblyScript's <code>asc</code> compiles to WebAssembly.</p> <h2 id="compiler-options"><a href="#compiler-options" class="header-anchor">#</a> Compiler options</h2> <p>The compiler supports various options available on the command line, in a configuration file and programmatically. On the command line, it looks like this:</p> <h3 id="entry-file-s"><a href="#entry-file-s" class="header-anchor">#</a> Entry file(s)</h3> <p>Non-option arguments are treated as the names of entry files. A single program can have multiple entries, with the exports of each entry becoming the exports of the WebAssembly module. Exports of imported files that are not entry files do not become WebAssembly module exports.</p> <div class="language-sh extra-class"><pre class="language-sh"><code>asc entryFile.ts
</code></pre></div><h3 id="general"><a href="#general" class="header-anchor">#</a> General</h3> <div class="language- extra-class"><pre class="language-text"><code>--version, -v         Prints just the compiler's version and exits.
--help, -h            Prints this message and exits.
--config              Configuration file to apply. CLI arguments take precedence.
--target              Configuration file target to use. Defaults to 'release'.
</code></pre></div><h3 id="optimization"><a href="#optimization" class="header-anchor">#</a> Optimization</h3> <p>The compiler can optimize for both speed (<code>-Ospeed</code>) and size (<code>-Osize</code>), as well as produce a debug build (<code>--debug</code>).</p> <div class="language- extra-class"><pre class="language-text"><code>--optimize, -O        Optimizes the module. Typical shorthands are:

                        Default optimizations   -O
                        Make a release build    -O --noAssert
                        Make a debug build      --debug
                        Optimize for speed      -Ospeed
                        Optimize for size       -Osize

--optimizeLevel       How much to focus on optimizing code. [0-3]
--shrinkLevel         How much to focus on shrinking code size. [0-2, s=1, z=2]
--converge            Re-optimizes until no further improvements can be made.
--noAssert            Replaces assertions with just their value without trapping.
--uncheckedBehavior   Changes the behavior of unchecked() expressions.
                      Using this option can potentially cause breakage.

                        default  The default behavior: unchecked operations are
                                 only used inside of unchecked().
                        never    Unchecked operations are never used, even when,
                                 inside of unchecked().
                        always   Unchecked operations are always used if possible,
                                 whether or not unchecked() is used.

</code></pre></div><p>Optimization levels can also be tweaked manually: <code>--optimizeLevel</code> (0-3) indicates how much the compiler focuses on optimizing the code with <code>--shrinkLevel</code> (0-2, 1=s, 2=z) indicating how much it focuses on keeping the size low during code generation and while optimizing. A shorthand for both is <code>-O[optimizeLevel][shrinkLevel]</code> , with shrink level indicated by optionally appending the letter <code>s</code> (1) or <code>z</code> (2).</p> <h3 id="output"><a href="#output" class="header-anchor">#</a> Output</h3> <p>Typical output formats are WebAssembly binary (.wasm, <code>--outFile</code>) and/or text format (.wat, <code>--textFile</code>). Often, both are used in tandem to run and also inspect generated code.</p> <div class="language- extra-class"><pre class="language-text"><code>--outFile, -o         Specifies the WebAssembly output file (.wasm).
--textFile, -t        Specifies the WebAssembly text output file (.wat).
--bindings, -b        Specifies the bindings to generate (.js + .d.ts).

                        esm  JavaScript bindings &amp; typings for ESM integration.
                        raw  Like esm, but exports just the instantiate function.
                             Useful where modules are meant to be instantiated
                             multiple times or non-ESM imports must be provided.
</code></pre></div><h3 id="debugging"><a href="#debugging" class="header-anchor">#</a> Debugging</h3> <p>For easier debugging during development, a <a href="#source-maps">source map</a> can be emitted alongside the WebAssembly binary, and debug symbols can be embedded:</p> <div class="language- extra-class"><pre class="language-text"><code>--sourceMap           Enables source map generation. Optionally takes the URL
                      used to reference the source map from the binary file.
--debug               Enables debug information in emitted binaries.
</code></pre></div><h3 id="features"><a href="#features" class="header-anchor">#</a> Features</h3> <p>There are several flags that enable or disable specific WebAssembly or compiler features. By default, only the bare minimum is exposed, and fully standardized WebAssembly features will be used.</p> <div class="language- extra-class"><pre class="language-text"><code>--importMemory        Imports the memory from 'env.memory'.
--noExportMemory      Does not export the memory as 'memory'.
--initialMemory       Sets the initial memory size in pages.
--maximumMemory       Sets the maximum memory size in pages.
--sharedMemory        Declare memory as shared. Requires maximumMemory.
--zeroFilledMemory    Assume imported memory is zeroed. Requires importMemory.
--importTable         Imports the function table from 'env.table'.
--exportTable         Exports the function table as 'table'.
--exportStart         Exports the start function using the specified name instead
                      of calling it implicitly. Useful for WASI or to obtain the
                      exported memory before executing any code accessing it.
--runtime             Specifies the runtime variant to include in the program.

                        incremental  TLSF + incremental GC (default)
                        minimal      TLSF + lightweight GC invoked externally
                        stub         Minimal runtime stub (never frees)
                        ...          Path to a custom runtime implementation

--exportRuntime       Always exports the runtime helpers (__new, __collect, __pin etc.).
                      Automatically determined when generation of --bindings is enabled.
--stackSize           Overrides the stack size. Only relevant for incremental GC
                      or when using a custom runtime that requires stack space.
                      Defaults to 0 without and to 16384 with incremental GC.
--enable              Enables WebAssembly features being disabled by default.

                        threads             Threading and atomic operations.
                        simd                SIMD types and operations.
                        reference-types     Reference types and operations.
                        gc                  Garbage collection (WIP).
                        stringref           String reference types.
                        relaxed-simd        Relaxed SIMD operations.

--disable             Disables WebAssembly features being enabled by default.

                        mutable-globals     Mutable global imports and exports.
                        sign-extension      Sign-extension operations
                        nontrapping-f2i     Non-trapping float to integer ops.
                        bulk-memory         Bulk memory operations.

--use, -u             Aliases a global object under another name, e.g., to switch
                      the default 'Math' implementation used: --use Math=JSMath
                      Can also be used to introduce an integer constant.
--lowMemoryLimit      Enforces very low (&lt;64k) memory constraints.
</code></pre></div><h3 id="linking"><a href="#linking" class="header-anchor">#</a> Linking</h3> <p>Specifying the base offsets of compiler-generated memory respectively the table leaves some space for other data in front. In its current form this is mostly useful to link additional data into an AssemblyScript binary after compilation, be it by populating the binary itself or initializing the data externally upon initialization. One good example is leaving some scratch space for a frame buffer.</p> <div class="language- extra-class"><pre class="language-text"><code>--memoryBase          Sets the start offset of emitted memory segments.
--tableBase           Sets the start offset of emitted table elements.
</code></pre></div><h3 id="api"><a href="#api" class="header-anchor">#</a> API</h3> <p>To integrate with the compiler, for example to post-process the AST, one or multiple custom <a href="#transforms">transforms</a> can be specified.</p> <div class="language- extra-class"><pre class="language-text"><code>--transform           Specifies the path to a custom transform to load.
</code></pre></div><h3 id="other"><a href="#other" class="header-anchor">#</a> Other</h3> <p>Other options include those forwarded to Binaryen and various flags useful in certain situations.</p> <h4 id="binaryen"><a href="#binaryen" class="header-anchor">#</a> Binaryen</h4> <div class="language- extra-class"><pre class="language-text"><code>--trapMode            Sets the trap mode to use.

                       allow  Allow trapping operations. This is the default.
                       clamp  Replace trapping operations with clamping semantics.
                       js     Replace trapping operations with JS semantics.

--runPasses           Specifies additional Binaryen passes to run after other
                      optimizations, if any. See: Binaryen/src/passes/pass.cpp
--noValidate          Skips validating the module using Binaryen.
</code></pre></div><h4 id="and-the-kitchen-sink"><a href="#and-the-kitchen-sink" class="header-anchor">#</a> And the kitchen sink</h4> <div class="language- extra-class"><pre class="language-text"><code>--baseDir             Specifies the base directory of input and output files.
--noColors            Disables terminal colors.
--noUnsafe            Disallows the use of unsafe features in user code.
                      Does not affect library files and external modules.
--disableWarning      Disables warnings matching the given diagnostic code.
                      If no diagnostic code is given, all warnings are disabled.
--noEmit              Performs compilation as usual but does not emit code.
--stats               Prints statistics on I/O and compile times.
--pedantic            Make yourself sad for no good reason.
--lib                 Adds one or multiple paths to custom library components and
                      uses exports of all top-level files at this path as globals.
--path                Adds one or multiple paths to package resolution, similar
                      to node_modules. Prefers an 'ascMain' entry in a package's
                      package.json and falls back to an inner 'assembly/' folder.
--wasm                Uses the specified Wasm binary of the compiler.
-- ...                Specifies node.js options (CLI only). See: node --help
</code></pre></div><h2 id="configuration-file"><a href="#configuration-file" class="header-anchor">#</a> Configuration file</h2> <p>Instead of providing the options outlined above on the command line, a configuration file typically named <strong>asconfig.json</strong> can be used. It may look like in the following example, excluding comments:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;extends&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./path/to/other/asconfig.json&quot;</span><span class="token punctuation">,</span> <span class="token comment">// (optional) base config</span>
  <span class="token property">&quot;entries&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token comment">// (optional) entry files, e.g.</span>
    <span class="token string">&quot;./assembly/index.ts&quot;</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;options&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// common options, e.g.</span>
    <span class="token property">&quot;importTable&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;targets&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// (optional) targets</span>
    <span class="token property">&quot;release&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// additional options for the &quot;release&quot; target, e.g.</span>
      <span class="token property">&quot;optimize&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token property">&quot;outFile&quot;</span><span class="token operator">:</span> <span class="token string">&quot;myModule.release.wasm&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;debug&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// additional options for the &quot;debug&quot; target, e.g.</span>
      <span class="token property">&quot;debug&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token property">&quot;outFile&quot;</span><span class="token operator">:</span> <span class="token string">&quot;myModule.debug.wasm&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Per-target options, e.g. <code>targets.release</code>, add to and override top-level <code>options</code>. Options provided on the command line override any options in the configuration file. Usage is, for example:</p> <div class="language-sh extra-class"><pre class="language-sh"><code>asc --config asconfig.json --target release
</code></pre></div><h2 id="programmatic-usage"><a href="#programmatic-usage" class="header-anchor">#</a> Programmatic usage</h2> <p>The compiler API can also be used programmatically:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> asc <span class="token keyword">from</span> <span class="token string">&quot;assemblyscript/asc&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token punctuation">{</span> error<span class="token punctuation">,</span> stdout<span class="token punctuation">,</span> stderr<span class="token punctuation">,</span> stats <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> asc<span class="token punctuation">.</span><span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  <span class="token comment">// Command line options</span>
  <span class="token string">&quot;myModule.ts&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;--outFile&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;myModule.wasm&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;--optimize&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;--sourceMap&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;--stats&quot;</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token comment">// Additional API options</span>
  stdout<span class="token operator">?</span><span class="token operator">:</span> <span class="token operator">...</span><span class="token punctuation">,</span>
  stderr<span class="token operator">?</span><span class="token operator">:</span> <span class="token operator">...</span><span class="token punctuation">,</span>
  readFile<span class="token operator">?</span><span class="token operator">:</span> <span class="token operator">...</span><span class="token punctuation">,</span>
  writeFile<span class="token operator">?</span><span class="token operator">:</span> <span class="token operator">...</span><span class="token punctuation">,</span>
  listFiles<span class="token operator">?</span><span class="token operator">:</span> <span class="token operator">...</span><span class="token punctuation">,</span>
  reportDiagnostic<span class="token operator">?</span><span class="token operator">:</span> <span class="token operator">...</span><span class="token punctuation">,</span>
  transforms<span class="token operator">?</span><span class="token operator">:</span> <span class="token operator">...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Compilation failed: &quot;</span> <span class="token operator">+</span> error<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>stderr<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>stdout<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The compiler runs in browsers as well. The simplest way to set it up is to include the generated <a href="https://cdn.jsdelivr.net/npm/assemblyscript@latest/dist/web.js" target="_blank" rel="noopener noreferrer">web.js<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> so the compiler can be used with an <code>import</code> on the Web:</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://cdn.jsdelivr.net/npm/assemblyscript@x.x.x/dist/web.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>module<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> asc <span class="token keyword">from</span> <span class="token string">&quot;assemblyscript/asc&quot;</span><span class="token punctuation">;</span>
<span class="token operator">...</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>Here, <code>x.x.x</code> must be replaced with the <a href="https://github.com/AssemblyScript/assemblyscript/tags" target="_blank" rel="noopener noreferrer">respective version to use<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, or <code>latest</code> to always use the latest version (not recommended in production). By default, the script installs <a href="https://cdn.jsdelivr.net/npm/assemblyscript@latest/dist/importmap.json" target="_blank" rel="noopener noreferrer">the necessary import map<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> and, for browsers that do not yet support import maps, <a href="https://github.com/guybedford/es-module-shims" target="_blank" rel="noopener noreferrer">an import map shim<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. It also accepts the following options in case there is a need to only perform part of the setup:</p> <table><thead><tr><th>Script URL</th> <th>Effect</th></tr></thead> <tbody><tr><td><code>web.js?noinstall</code></td> <td>Does not install the import map.</td></tr> <tr><td><code>web.js?noshim</code></td> <td>Does not install the import map shim.</td></tr> <tr><td><code>web.js?noinstall,noshim</code></td> <td>Does not install the import map or shim.</td></tr></tbody></table> <p>Regardless of the options used, the script always declares the following global variables:</p> <table><thead><tr><th>Variable</th> <th>Description</th></tr></thead> <tbody><tr><td><code>ASSEMBLYSCRIPT_VERSION</code></td> <td>Version string of the compiler release used</td></tr> <tr><td><code>ASSEMBLYSCRIPT_IMPORTMAP</code></td> <td>The respective import map of the release as JSON</td></tr></tbody></table> <h2 id="host-bindings"><a href="#host-bindings" class="header-anchor">#</a> Host bindings</h2> <p>WebAssembly alone cannot yet transfer higher level data types like strings, arrays and objects over module boundaries, so for now some amount of glue code is required to exchange these data structures with the host / JavaScript.</p> <p>The compiler can generate the necessary bindings using the <code>--bindings</code> command line option (either as an ES module or a raw instantiate function), enabling exchange of:</p> <table><thead><tr><th>Type</th> <th>Strategy</th> <th>Description</th></tr></thead> <tbody><tr><td>Number</td> <td>By value</td> <td>Basic numeric types except 64-bit integers.</td></tr> <tr><td>BigInt</td> <td>By value</td> <td>64-bit integers via js-bigint-integration.</td></tr> <tr><td>Boolean</td> <td>By value</td> <td>Coerced to <code>true</code> or <code>false</code>.</td></tr> <tr><td>Externref</td> <td>By reference</td> <td>Using reference-types.</td></tr> <tr><td><strong>String</strong></td> <td>Copy</td> <td></td></tr> <tr><td><strong>ArrayBuffer</strong></td> <td>Copy</td> <td></td></tr> <tr><td><strong>TypedArray</strong></td> <td>Copy</td> <td>Any <code>Int8Array</code>, <code>Float64Array</code> etc.</td></tr> <tr><td><strong>Array</strong></td> <td>Copy</td> <td>Any <code>Array&lt;T&gt;</code></td></tr> <tr><td><strong>StaticArray</strong></td> <td>Copy</td> <td>Any <code>StaticArray&lt;T&gt;</code></td></tr> <tr><td><strong>Object</strong></td> <td>Copy</td> <td>If a plain object. That is: Has no constructor or non-public fields.</td></tr> <tr><td><strong>Object</strong></td> <td>By reference</td> <td>If not a plain object. Passed as an opaque reference counted pointer.</td></tr></tbody></table> <p>Note the two different strategies used for <strong>Object</strong>: In some situations, say when calling a Web API, it may be preferable to copy the object as a whole, field by field, which is the strategy chosen for plain objects with no constructor or non-public fields:</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// Copied to a JS object</span>
<span class="token keyword">class</span> <span class="token class-name">PlainObject</span> <span class="token punctuation">{</span>
  field<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">getObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> PlainObject <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    field<span class="token operator">:</span> <span class="token string">&quot;hello world&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>However, copying may not be desirable in every situation, say when individual object properties are meant to be modified externally where serializing/deserializing the object as a whole would result in unnecessary overhead. To support this use case, the compiler can pass just an opaque reference to the object, which can be enforced by providing an empty <code>constructor</code> (not a plain object anymore):</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// Not copied to a JS object</span>
<span class="token keyword">class</span> <span class="token class-name">ComplexObject</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">// !</span>
  field<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">newObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> ComplexObject <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ComplexObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">setObjectField</span><span class="token punctuation">(</span>target<span class="token operator">:</span> ComplexObject<span class="token punctuation">,</span> field<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
  target<span class="token punctuation">.</span>field <span class="token operator">=</span> field<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">getObjectField</span><span class="token punctuation">(</span>target<span class="token operator">:</span> ComplexObject<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token keyword">null</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> target<span class="token punctuation">.</span>field<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Also note that exporting an entire <code>class</code> has no effect at the module boundary (yet), and it is instead recommended to expose only the needed functionality as shown in the example above. Supported elements at the boundary are globals, functions and enums.</p> <h3 id="using-esm-bindings"><a href="#using-esm-bindings" class="header-anchor">#</a> Using ESM bindings</h3> <p>Bindings generated with <code>--bindings esm</code> perform all the steps from compilation over instantiation to exporting the final interface. To do so, a few assumptions had to be made:</p> <ul><li><p>The WebAssembly binary is located next to the JavaScript bindings file using the same name but with a <code>.wasm</code> extension.</p> <div class="language- extra-class"><pre class="language-text"><code>build/mymodule.js
build/mymodule.wasm
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> myModule <span class="token keyword">from</span> <span class="token string">&quot;./build/mymodule.js&quot;</span>
</code></pre></div></li> <li><p>JavaScript globals in <code>globalThis</code> can be accessed directly via the <code>env</code> module namespace. For example, <code>console.log</code> can be manually imported through:</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token decorator"><span class="token at operator">@</span><span class="token function">external</span></span><span class="token punctuation">(</span><span class="token string">&quot;env&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;console.log&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token function">consoleLog</span><span class="token punctuation">(</span>s<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span>
</code></pre></div><p>Note that this is just an example and <code>console.log</code> is already provided by the standard library when called from an AssemblyScript file. Other global functions not already provided by the standard library may require an import as of this example, though.</p></li> <li><p>Imports from other namespaces than <code>env</code>, i.e. <code>(import &quot;module&quot; &quot;name&quot;)</code>, become an <code>import { name } from &quot;module&quot;</code> within the binding. Importing a custom function from a JavaScript file next to the bindings file can be achieved through:</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token decorator"><span class="token at operator">@</span><span class="token function">external</span></span><span class="token punctuation">(</span><span class="token string">&quot;./otherfile.js&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;myFunction&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token function">myFunction</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token operator">...</span>
</code></pre></div><p>Similarly, importing a custom function from, say, a Node.js dependency can be achieved through:</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token decorator"><span class="token at operator">@</span><span class="token function">external</span></span><span class="token punctuation">(</span><span class="token string">&quot;othermodule&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;myFunction&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token function">myFunction</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token operator">...</span>
</code></pre></div></li></ul> <p>These assumptions cannot be intercepted or customized since, to provide static ESM exports from the bindings file directly, instantiation must start immediately when the bindings file is imported. If customization is required, <code>--bindings raw</code> can be used instead.</p> <h3 id="using-raw-bindings"><a href="#using-raw-bindings" class="header-anchor">#</a> Using raw bindings</h3> <p>The signature of the single <code>instantiate</code> function exported by <code>--bindings raw</code> is:</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">instantiate</span><span class="token punctuation">(</span>module<span class="token operator">:</span> WebAssembly<span class="token punctuation">.</span>Module<span class="token punctuation">,</span> imports<span class="token operator">?</span><span class="token operator">:</span> WebAssembly<span class="token punctuation">.</span>Imports<span class="token punctuation">)</span><span class="token operator">:</span> AdaptedExports
</code></pre></div><p>Note that the function does not make any assumptions on how the module is to be compiled, but instead expects a readily compiled <code>WebAssembly.Module</code> as in this example:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> instantiate <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./module.js&quot;</span>
<span class="token keyword">const</span> exports <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">instantiate</span><span class="token punctuation">(</span><span class="token keyword">await</span> WebAssembly<span class="token punctuation">.</span><span class="token function">compileStreaming</span><span class="token punctuation">(</span><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&quot;./module.wasm&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token comment">/* imports */</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>Unlike <code>--bindings esm</code>, raw bindings also do not make any assumptions on how imports are resolved, so these must be provided manually as part of the imports object. For example, to achieve a similar result as with ESM bindings, but now customizable:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> instantiate <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./module.js&quot;</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> other <span class="token keyword">from</span> <span class="token string">&quot;./otherfile.js&quot;</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token punctuation">{</span>
  export1<span class="token punctuation">,</span>
  export2<span class="token punctuation">,</span>
  <span class="token operator">...</span>
<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">instantiate</span><span class="token punctuation">(</span><span class="token keyword">await</span> WebAssembly<span class="token punctuation">.</span><span class="token function">compileStreaming</span><span class="token punctuation">(</span><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&quot;./module.wasm&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token string-property property">&quot;./otherfile.js&quot;</span><span class="token operator">:</span> other
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="debugging-2"><a href="#debugging-2" class="header-anchor">#</a> Debugging</h2> <p>The debugging workflow is similar to debugging JavaScript since both Wasm and JS execute in the same engine, and the compiler provides various options to set up additional WebAssembly-specific debug information. Note that any sort of optimization should be disabled in debug builds.</p> <h3 id="debug-symbols"><a href="#debug-symbols" class="header-anchor">#</a> Debug symbols</h3> <p>When compiling with the <code>--debug</code> option, the compiler appends a name section to the binary, containing names of functions, globals, locals and so on. These names will show up in stack traces.</p> <h3 id="source-maps"><a href="#source-maps" class="header-anchor">#</a> Source maps</h3> <p>The compiler can generate a source map alongside a binary using the <code>--sourceMap</code> option. By default, a relative source map path will be embedded in the binary which browsers can pick up when instantiating a module from a <code>fetch</code> response. In environments that do not provide <code>fetch</code> or an equivalent mechanism, like in Node.js, it is alternatively possible to embed an absolute source map path through <code>--sourceMap path/to/source/map</code>.</p> <h3 id="breakpoints"><a href="#breakpoints" class="header-anchor">#</a> Breakpoints</h3> <p>Some JavaScript engines also support adding break points directly in WebAssembly code. Please consult your engine's documentation: <a href="https://developers.google.com/web/tools/chrome-devtools/javascript/breakpoints" target="_blank" rel="noopener noreferrer">Chrome<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, <a href="https://developer.mozilla.org/en-US/docs/Tools/Debugger/How_to/Set_a_breakpoint" target="_blank" rel="noopener noreferrer">Firefox<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, <a href="https://nodejs.org/api/debugger.html" target="_blank" rel="noopener noreferrer">Node.js<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, <a href="https://support.apple.com/de-de/guide/safari-developer/dev5e4caf347/mac" target="_blank" rel="noopener noreferrer">Safari<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h2 id="transforms"><a href="#transforms" class="header-anchor">#</a> Transforms</h2> <p>AssemblyScript is compiled statically, so code transformation cannot be done at runtime but must instead be performed at compile-time. To enable this, the compiler frontend (asc) provides a mechanism to hook into the compilation process before, while and after the module is being compiled.</p> <p>Specifying <code>--transform ./myTransform.js</code> on the command line will load the node module pointed to by <code>./myTransform.js</code>.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> assemblyscript <span class="token keyword">from</span> <span class="token string">&quot;assemblyscript&quot;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Transform <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;assemblyscript/transform&quot;</span>
<span class="token keyword">class</span> <span class="token class-name">MyTransform</span> <span class="token keyword">extends</span> <span class="token class-name">Transform</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> MyTransform
</code></pre></div><h3 id="properties"><a href="#properties" class="header-anchor">#</a> Properties</h3> <p>A transform is an ES6 class/node module with the following inherited properties:</p> <ul><li><div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">readonly</span> program<span class="token operator">:</span> Program
</code></pre></div><p>Reference to the <code>Program</code> instance.</p></li> <li><div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">readonly</span> baseDir<span class="token operator">:</span> <span class="token builtin">string</span>
</code></pre></div><p>Base directory used by the compiler.</p></li> <li><div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">readonly</span> stdout<span class="token operator">:</span> OutputStream
</code></pre></div><p>Output stream used by the compiler.</p></li> <li><div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">readonly</span> stderr<span class="token operator">:</span> OutputStream
</code></pre></div><p>Error stream uses by the compiler.</p></li> <li><div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">readonly</span> log<span class="token operator">:</span> <span class="token keyword">typeof</span> console<span class="token punctuation">.</span>log
</code></pre></div><p>Logs a message to console.</p></li> <li><div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">writeFile</span><span class="token punctuation">(</span>filename<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> contents<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">Uint8Array</span><span class="token punctuation">,</span> baseDir<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">boolean</span>
</code></pre></div><p>Writes a file to disk.</p></li> <li><div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">readFile</span><span class="token punctuation">(</span>filename<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> baseDir<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token keyword">null</span>
</code></pre></div><p>Reads a file from disk.</p></li> <li><div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">listFiles</span><span class="token punctuation">(</span>dirname<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> baseDir<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">|</span> <span class="token keyword">null</span>
</code></pre></div><p>Lists all files in a directory.</p></li></ul> <h3 id="hooks"><a href="#hooks" class="header-anchor">#</a> Hooks</h3> <p>The frontend will call several hooks, if present on the transform, during the compilation process:</p> <ul><li><div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">afterParse</span><span class="token punctuation">(</span>parser<span class="token operator">:</span> Parser<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span>
</code></pre></div><p>Called when parsing is complete, before a program is initialized from the AST. Note that types are not yet known at this stage and there is no easy way to obtain them.</p></li> <li><div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">afterInitialize</span><span class="token punctuation">(</span>program<span class="token operator">:</span> Program<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span>
</code></pre></div><p>Called once the program is initialized, before it is being compiled. Types are known at this stage, respectively can be resolved where necessary.</p></li> <li><div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">afterCompile</span><span class="token punctuation">(</span>module<span class="token operator">:</span> Module<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span>
</code></pre></div><p>Called with the resulting module before it is being emitted. Useful to modify the IR before writing any output, for example to replace imports with actual functionality or to add custom sections.</p></li></ul> <p>Transforms are a very powerful feature, but may require profound knowledge of the compiler to utilize them to their full extent, so reading through the compiler sources is a plus.</p> <h2 id="portability"><a href="#portability" class="header-anchor">#</a> Portability</h2> <p>With AssemblyScript being very similar to TypeScript, there comes the opportunity to compile the same code to JavaScript with <code>tsc</code> and WebAssembly with <code>asc</code>. The AssemblyScript compiler itself is portable code. Writing portable code is largely a matter of double-checking that the intent translates to the same outcome in both the strictly typed AssemblyScript and the types-stripped-away TypeScript worlds.</p> <h3 id="portable-standard-library"><a href="#portable-standard-library" class="header-anchor">#</a> Portable standard library</h3> <p>Besides the full standard library, AssemblyScript provides a portable variant of the functionality that is present in both JavaScript and WebAssembly. In addition to that, the portable library lifts some of the functionality that is only available with <code>asc</code> to JavaScript, like the portable conversions mentioned below.</p> <p>Also note that some parts of JavaScript's standard library function a little more loosely than how they would when compiling to WebAssembly. While the portable definitions try to take care of this, one example where this can happen is <code>Map#get</code> returning <code>undefined</code> when a key cannot be found in JavaScript, while resulting in an abort in WebAssembly, where it is necessary to first check that the key exists using <code>Map#has</code>.</p> <p>To use the portable library, extend <code>assemblyscript/std/portable.json</code> instead of <code>assemblyscript/std/assembly.json</code> within <code>tsconfig.json</code> and add the following somewhere along your build step so the portable features are present in the environment:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token string">&quot;assemblyscript/std/portable.js&quot;</span>
</code></pre></div><p>Note that the portable standard library is still a work in progress and so far focuses on functionality useful to make the compiler itself portable, so if you need something specific, feel free to improve <a href="https://github.com/AssemblyScript/assemblyscript/tree/main/std/portable" target="_blank" rel="noopener noreferrer">its definitions and feature set<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h3 id="portable-conversions"><a href="#portable-conversions" class="header-anchor">#</a> Portable conversions</h3> <p>While <code>asc</code> understands the meaning of</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// non-portable</span>
<span class="token keyword">let</span> someFloat<span class="token operator">:</span> <span class="token builtin">f32</span> <span class="token operator">=</span> <span class="token number">1.5</span>
<span class="token keyword">let</span> someInt<span class="token operator">:</span> <span class="token builtin">i32</span> <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token builtin">i32</span><span class="token operator">&gt;</span>someFloat
</code></pre></div><p>and then inserts the correct conversion steps, <code>tsc</code> does not because all numeric types are just aliases of <code>number</code>. Hence, when targeting JavaScript with <code>tsc</code>, the above will result in</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> someFloat <span class="token operator">=</span> <span class="token number">1.5</span>
<span class="token keyword">var</span> someInt <span class="token operator">=</span> someFloat
</code></pre></div><p>which is obviously wrong. To account for this, portable conversions can be used, resulting in actually portable code. For example</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// portable</span>
<span class="token keyword">let</span> someFloat<span class="token operator">:</span> <span class="token builtin">f32</span> <span class="token operator">=</span> <span class="token number">1.5</span>
<span class="token keyword">let</span> someInt<span class="token operator">:</span> <span class="token builtin">i32</span> <span class="token operator">=</span> <span class="token function">i32</span><span class="token punctuation">(</span>someFloat<span class="token punctuation">)</span>
</code></pre></div><p>will essentially result in</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> someFloat <span class="token operator">=</span> <span class="token number">1.5</span>
<span class="token keyword">var</span> someInt <span class="token operator">=</span> someFloat <span class="token operator">|</span> <span class="token number">0</span>
</code></pre></div><p>which is correct. The best way of dealing with this is asking yourself the question: What would this code do when compiled to JavaScript?</p> <h3 id="portable-overflows"><a href="#portable-overflows" class="header-anchor">#</a> Portable overflows</h3> <p>Likewise, again because <code>asc</code> knows the meaning but <code>tsc</code> does not, overflows must be handled explicitly:</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// non-portable</span>
<span class="token keyword">let</span> someU8<span class="token operator">:</span> <span class="token builtin">u8</span> <span class="token operator">=</span> <span class="token number">255</span>
<span class="token keyword">let</span> someOtherU8<span class="token operator">:</span> <span class="token builtin">u8</span> <span class="token operator">=</span> someU8 <span class="token operator">+</span> <span class="token number">1</span>
</code></pre></div><div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// portable</span>
<span class="token keyword">let</span> someU8<span class="token operator">:</span> <span class="token builtin">u8</span> <span class="token operator">=</span> <span class="token number">255</span>
<span class="token keyword">let</span> someOtherU8<span class="token operator">:</span> <span class="token builtin">u8</span> <span class="token operator">=</span> <span class="token function">u8</span><span class="token punctuation">(</span>someU8 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
</code></pre></div><p>essentially resulting in</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> someU8 <span class="token operator">=</span> <span class="token number">255</span>
<span class="token keyword">let</span> someOtherU8 <span class="token operator">=</span> <span class="token punctuation">(</span>someU8 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span>
</code></pre></div><h3 id="non-portable-code"><a href="#non-portable-code" class="header-anchor">#</a> Non-portable code</h3> <p>In JavaScript, all numeric values are IEEE754 doubles that cannot represent the full range of values fitting in a 64-bit integer (<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/MAX_SAFE_INTEGER" target="_blank" rel="noopener noreferrer">max. safe integer<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> is <code>2^53 - 1</code>). Hence <code>i64</code> and <code>u64</code> are not portable and not present in <code>std/portable</code>. There are several ways to deal with this. One is to use an i64 polyfill like <a href="https://github.com/AssemblyScript/examples/tree/main/i64" target="_blank" rel="noopener noreferrer">in this example<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>Other than that, portable code (JavaScript) does not have a concept of memory, so there are no <code>load</code> and <code>store</code> implementations in the portable standard library. Technically this can be polyfilled in various ways, but no default is provided since actual implementations are expected to be relatively specific (for instance: the portable compiler accesses Binaryen's memory).</p></div> <footer class="page-edit" data-v-bb3fd134><div class="edit-link"><a href="https://github.com/AssemblyScript/website/edit/main/src/compiler.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav" data-v-bb3fd134><p class="inner"><span class="prev">
      ←
      <a href="/getting-started.html" class="prev">
        Getting started
      </a></span> <span class="next"><a href="/concepts.html">
        Concepts
      </a>
      →
    </span></p></div> <div class="footer" data-v-bb3fd134 data-v-7c0e63ba><p data-v-bb3fd134 data-v-7c0e63ba><span class="item" data-v-bb3fd134 data-v-7c0e63ba>Apache-2.0 licensed</span>,
      <span class="item" data-v-bb3fd134 data-v-7c0e63ba>Copyright © 2020-2025</span> <span class="item" data-v-bb3fd134 data-v-7c0e63ba>The AssemblyScript Authors</span></p></div></main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.f1b33501.js" defer></script><script src="/assets/js/4.bff817ab.js" defer></script><script src="/assets/js/3.414e7e2a.js" defer></script><script src="/assets/js/22.ec6e0f2b.js" defer></script>
  </body>
</html>
